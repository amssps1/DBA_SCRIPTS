
 DECLARE @Deleted_Rows INT;
 SET @Deleted_Rows = 1;


 WHILE (@Deleted_Rows > 0)
   BEGIN
    BEGIN transaction
    -- Delete some small number of rows at a time
	    
    DELETE TOP (25000)  FROM VG_Tarefas  
    WHERE DataCriacao < '01-01-2021' ;
    SET @Deleted_Rows = @@ROWCOUNT;
	COMMIT TRANSACTION
	PRINT @Deleted_Rows
    waitfor DELAY '00:00:02:000'
 END
 